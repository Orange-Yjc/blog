---
title: EC-CUBEãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–¢é€£
subtitle: PDFå‡ºåŠ›æ©Ÿèƒ½å®Ÿç¾

# Summary for listings and search engines
# summary: Welcome ğŸ‘‹ We know that first impressions are important, so we've populated your new site with some initial content to help you get familiar with everything in no time.

# Link this post with a project
projects: []

# Date published
date: '2023-8-17 22:48:20'

# Date updated
lastmod: '2023-8-17 22:48:20'

# Is this an unpublished draft?
draft: false

# Show this page in the Featured widget?
featured: true

# Featured image
# Place an image named `featured.jpg/png` in this page's folder and customize its options here.
image:
  caption: 'Image credit: [**Unsplash**](https://unsplash.com/ja/%E5%86%99%E7%9C%9F/1Halnow29UM)'
  focal_point: ''
  placement: 2
  preview_only: false

authors:
  - admin

tags:
  - EC-CUBE
  - PHP
  - Smarty
  - PhpSpreadsheet

categories:
  - Memo
---
# ä»Šæ—¥æ€»ç»“

## EC-CUBEçš„PDFå¯¼å‡ºç›¸å…³åŠŸèƒ½å®è£…

å·²å®ç°åŠŸèƒ½ä¸ºload Excelå¹¶è¿›è¡Œæ•°æ®å¤„ç†ï¼Œå†å¯¼å‡ºExcelæ–‡ä»¶ã€‚æ‰‹é¡ºâ†’

1. é€šè¿‡composer.jsonæŒ‡å®šphpå’Œsmartyç‰ˆæœ¬

```
"platform": {
	"php": "7.4"
},
"require": {
	"smarty/smarty": "^3.1.48"
}
```

â€‹		composer updateã‚’å®Ÿæ–½

2. å®‰è£…phpspreadsheetåŒ…

```
composer require phpoffice/phpspreadsheet
```

3. å¯¼åŒ…ï¼Œåœ¨éœ€è¦ä½¿ç”¨çš„controlleræ–‡ä»¶ä¸­

   <?phpã®ç›´å¾Œã€classã®ä¸Šã«ä¸‹è¨˜ã‚’è¿½è¨˜

   ```php
   use PhpOffice\PhpSpreadsheet\Reader\Xlsx as XlsxReader; 
   use PhpOffice\PhpSpreadsheet\Writer\Xlsx as XlsxWriter;
   ```

4. å®é™…å¯¼å‡ºæ“ä½œä¸¾ä¾‹

   ```php
   $filePath = HTML_REALDIR . "upload/temp_xlsx/test.xlsx";
   $reader = new XlsxReader();
   //å¯¼å…¥æ–‡ä»¶åˆ°spreadsheet
   $spreadsheet = $reader->load($filePath);
   //è·å–excelæƒ³è¦ç¼–è¾‘çš„æ–‡ä»¶é¡µç 
   $worksheet = $spreadsheet->getSheetByName('test');
   //insert data
   $worksheet->setCellValue('B3', '4');
   
   $fileNewName = "newName.xlsx";
   
   //method 1
   //å¦ä¿å­˜ä¸ºåˆ«çš„æ–‡ä»¶å,æŒ‡å®šè·¯å¾„
   $fileNewPath = HTML_REALDIR . "upload/temp_xlsx/" . $fileNewName;
   $writer = new XlsxWriter($spreadsheet);
   //æ–‡ä»¶å¯¼å‡ºåˆ°æŒ‡å®šæ–‡ä»¶å¤¹çš„æ–‡ä»¶å
   $writer->save($fileNewPath);
   
   //method 2
   //åœ¨æŒ‡å®šé¡µé¢å¯ä»¥ä¸‹è½½excel fileçš„æ–¹æ³•æ¥ç”¨æˆ·æŒ‡å®šå¦å­˜ä¸º
   header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;');
   header('Content-Disposition: attachment; filename="'.$fileNewName.'"');
   header('Cache-Control: max-age=0');
   
   $writer = new XlsxWriter($spreadsheet);
   $writer->save('php://output');
   
   $exit;
   ```

## ãƒ¡ãƒ¢

### docker containerè¿›å…¥æ–¹æ³•

```
docker-compose exec <ContainerName> bash
```

### PHP packageå®‰è£…æ–¹æ³•

1. ä½¿ç”¨composer.jsonæ–‡ä»¶çš„ require è¿›è¡Œå®šä¹‰å®‰è£…

2. dockerç¯å¢ƒä¸‹ è¿›å…¥containerä¹‹å ä½¿ç”¨

   ```
   composer require <package name>:version
   ```

### docker åº”ç”¨å®‰è£…æ–¹æ³•

```
apt update/apt-get update

apt install <package name>
```



## ã§ãã¦ãªã„ã“ã¨

phpåœ¨å¯¼å‡ºPDFçš„æ–¹æ³•ä¸­ï¼Œç›®å‰å·²çŸ¥çš„mpdfï¼Œtcpdfç­‰ç­‰å‡å‡ºç°äº†æ˜¾ç¤ºç©ºç™½æˆ–è€…ä¹±ç çš„æƒ…å†µã€‚

è¿˜æœ‰libreofficeæ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡dockeråº”ç”¨å®‰è£…æ–¹æ³•è¿›è¡Œå®‰è£…ï¼Œå¯æ“ä½œæ€§ç›®å‰ä»åœ¨æ¢ç´¢



## ITæ–¹é¢çš„æŠ€æœ¯æå‡

1. PHPçš„å¯¼åŒ…ï¼Œdockerçš„å¯¼åŒ…ç›¸åº”æŠ€æœ¯æµç¨‹æœ‰äº†ä¸€å®šäº†è§£

2. PHPçš„excelç¼–è¾‘ç±»åŸºç¡€åŠŸèƒ½æœ‰äº†ä¸€å®šäº†è§£ï¼Œè¾“å…¥è¾“å‡º